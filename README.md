MQTT Emulator. Эмулятор данных по протоколу MQTT.      
Внутри эмулятора создаются виртуальные экземпляры счетчиков, которые хранят в памяти свои значения, настройки и состояния. Данные генерируются рандомно, но учитывают свое текущее значение, и уже от него происходит изменение. Так же в логику работы включена небольшая коррекция, привязанная ко времени. Каждый счетчик шлет значения в заданных пределах. Если следующее сгенерированное значение выйдет за пределы, то оно не отправится на сервер, а отправится предыдущее(нормальное). При этом, изменится переменная balance  таким образом, что показание данного счетчика начнет плавно уменьшаться(или увеличиваться).
        
```
Usage of mqtt-emulator (flags):
  -clog
        run emulator with log to console
  -gui
        run emulator with GUI
```

        
**Доступные типы счетчиков:**
* Инфракрасные счетчики
* Датчики температуры
* датчики освещенности
* датчики Со2


**Принципы работы.**

*Инфракрасные датчики:*
* Посылает данные на сервер только в случае изменения ситуации. Например, человек встал из-за стола - датчик прислал "0", человек вернулся - прислал "1". Остальное время датчик ничего не присылает.

*Датчики температуры, освещенности и Со2:*
* Присылают свои текущие показатели со строго заданной периодичностью опроса.

**Конфигурация**

```
{  
"mqttserver": {  
    "host": "0.0.0.0",          -сервер для подключения  
    "port": "1883",             -порт сервера  
    "login": "",                -логин  
    "password": ""              -пароль  
    "topic": "iot/floor10",                     -топик брокера(куда он посылает данные)
    "commandtopic": "iot/floor10/commands/#"    -топик команд(откуа он читает команды)
  },  
  "ir": {               --инфракрасные датчики  
    "enabled": true,    -ключ активирования датчиков. true - активны, false - нет  
    "count": 50,        -количество генерируемых устройств  
    "interval": 3000,   -интервал опроса(миллисекунд)  
    "all": "",          -если "1" - все датчики шлют 1, если "0" - то 0 (Кавычки обязательны)
    "chance": 20        -вероятность изменения значения датчика  
  },  
  "temparature": {      --датчики температуры  
    "enabled": true,    -ключ активирования датчиков. true - активны, false - нет  
    "count": 10,        -количество генерируемых устройств  
    "interval": 5000,   -интервал опроса  
    "range": {          -пределы генерируемых значений  
      "low": 20,  
      "high": 30  
    },  
    "overflowcount": 3,  -количество датчиков показывающих запредельные значения  
    "chance": 100       -вероятность изменения значения датчика  
  },  
  "light": {            --датчики освещенности  
    "enabled": true,  
    "count": 10,  
    "interval": 4000,  
    "range": {  
      "low": 2000,  
      "high": 5000  
    },  
    "overflowcount": 1,
    "chance": 100
  },  
  "co2": {              --датчики со2  
    "enabled": true,  
    "count": 10,  
    "interval": 6000,  
    "range": {  
      "low": 800,  
      "high": 1200  
    },  
    "overflowcount": 1,
    "chance": 100
  }   
}
```


**Форматы сообщений на сервер**

JSON-ы
```JSON
{"ID":"6", "time":"2019-03-07 13:44:00", "type":"temperature", "value":"37.31"}
{"ID":"7", "time":"2019-03-07 13:43:59", "type":"light", "value":"1015.54"}
{"ID":"8", "time":"2019-03-07 13:43:57", "type":"co2", "value":"1150.05"}
{"ID":"27", "time":"2019-03-07 13:43:24", "type":"ir", "value":"0"}
```
**Топики на сервере**(корнейвую часть можно задавать в конфиге)

* "iot/floor10/ir/"
* "iot/floor10/temperature/"
* "iot/floor10/light/"
* "iot/floor10/co2/"

- Каждое устройство пишет в свой топик со своим ID, например "iot/floor10/co2/5" или "iot/floor10/ir/107"


**Команды для устройств.**

Команды для устройств необходимо слать в топик *"iot/floor10/commands/#"*, или любой другой, какой сами пропишете в конфиге.        
Формат сообщения-команды: {"type":"<тип счетчика>", "id":<id счетчика>, "cmd":"<команда>", "value":"<значение>"}        

* "enabled" - Включение/выключение конкретного счетчика. Например::
```JSON
{"type":"light", "id":1, "cmd":"enabled", "value":"true"}
{"type":"ir", "id":0, "cmd":"enabled", "value":"false"}
```
* "balance" - Вероятность прибавление/убавления коррекции(от 0 до 100). Если 50 - то шанс прибавить или убавить - 50%. если >50 - то увеличивается шанс отнять, Соответственное <50 - увеличивается шанс прибавить. Например:
```JSON
{"type":"light", "id":1, "cmd":"balance", "value":"65"}
{"type":"co2", "id":0, "cmd":"balance", "value":"34"}
```
* "chance" - Шанс, с которым счетчик изменит свое значение при каждой итерации(от 0 до 100) . Например::
```JSON
{"type":"light", "id":1, "cmd":"chance", "value":"60"}
{"type":"co2", "id":0, "cmd":"chance", "value":"100"}
```
* "rangeLow" - Задать нижнюю границу значений для счетчика. Например::
```JSON
{"type":"light", "id":1, "cmd":"rangeLow", "value":"160"}
{"type":"co2", "id":0, "cmd":"rangeLow", "value":"30"}
```
* "rangeHigh" - Задать верхнюю границу значений для счетчика. Например::
```JSON
{"type":"light", "id":1, "cmd":"rangeHigh", "value":"1160"}
{"type":"co2", "id":0, "cmd":"rangeHigh", "value":"130"}
```
